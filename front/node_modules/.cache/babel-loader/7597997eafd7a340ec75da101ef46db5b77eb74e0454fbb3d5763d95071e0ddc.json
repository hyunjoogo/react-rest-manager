{"ast":null,"code":"var _jsxFileName = \"/Users/hyunjoo/cording/typescript/react-rest-manager/front/src/dialog/DialogManager.js\";\nimport React from 'react';\nimport classNames from \"classnames\";\nimport { createEventBusHelper } from \"../utils/EventBusHelper\";\nimport EventTypes from \"../consts/EventTypes\";\n\n// EventBusHelper라는 새로운 인스턴스를 생성한다.\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst EventBusHelper = createEventBusHelper();\nexport default class DialogManager extends React.Component {\n  static push(dialog) {\n    EventBusHelper.publish(EventTypes.Dialog.Push, dialog);\n  }\n  static pushAsync(dialog) {\n    return new Promise((resolve, reject) => {\n      EventBusHelper.publish(EventTypes.Dialog.Push, /*#__PURE__*/React.cloneElement(dialog, {\n        onClose: resolve\n      }));\n    });\n  }\n  static pop() {\n    EventBusHelper.publish(EventTypes.Dialog.Pop);\n  }\n  constructor(props, context) {\n    super(props, context);\n\n    // this.push에는 this가 this로 고정된 this.push이 할당\n    this._isMounted = false;\n    this.state = {\n      stack: []\n    };\n    this.push = this.push.bind(this);\n    this.pop = this.pop.bind(this);\n    EventBusHelper.addListener(EventTypes.Dialog.Push, this.push);\n    EventBusHelper.addListener(EventTypes.Dialog.Pop, this.pop);\n  }\n  componentDidMount() {\n    this._isMounted = true;\n  }\n  componentDidUnMount() {\n    this._isMounted = false;\n    EventBusHelper.removeAllListeners();\n  }\n  id() {\n    const alpha = 'qwertyuiopasdfghjklzxcvbnm'.split('');\n    let id = '';\n    while (alpha.length) {\n      const i = Math.floor(Math.random() * alpha.length);\n      id += alpha[i];\n      alpha.splice(i, 1);\n    }\n    return id;\n  }\n  push(dialog) {\n    if (!this._isMounted) {\n      return;\n    }\n    const newStack = this.state.stack.slice();\n    newStack.push({\n      id: this.id(),\n      show: true,\n      dialog\n    });\n    this.setState(() => ({\n      stack: newStack\n    }));\n  }\n  pop() {\n    if (!this._isMounted) {\n      return;\n    }\n    let {\n      stack\n    } = this.state;\n    let top = null;\n    for (let i = stack.length - 1; 0 <= i; i--) {\n      const item = stack[i];\n      if (item.show === true) {\n        top = item;\n        break;\n      }\n    }\n    if (!top) {\n      return;\n    }\n    top.show = false;\n    this.forceUpdate();\n    setTimeout(() => {\n      const newStack = stack.reduce((array, value, index) => {\n        if (top.id !== value.id) {\n          array.push(value);\n        }\n        return array;\n      }, []);\n      this.setState({\n        stack: newStack\n      });\n    }, 300);\n  }\n  render() {\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: this.state.stack.map((value, index) => {\n        const {\n          id,\n          show,\n          dialog\n        } = value;\n        const child = /*#__PURE__*/React.cloneElement(dialog, {\n          show,\n          onClose: result => {\n            this.pop();\n            if (dialog.props.onClose) {\n              setTimeout(() => {\n                dialog.props.onClose(result);\n              }, 300);\n            }\n          }\n        });\n        const classes = classNames('c-default-layout', 'c-legacy-theme', `dialog-${index}`);\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: classes,\n          children: child\n        }, id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 18\n        }, this);\n      })\n    }, void 0, false);\n  }\n}","map":{"version":3,"names":["React","classNames","createEventBusHelper","EventTypes","EventBusHelper","DialogManager","Component","push","dialog","publish","Dialog","Push","pushAsync","Promise","resolve","reject","cloneElement","onClose","pop","Pop","constructor","props","context","_isMounted","state","stack","bind","addListener","componentDidMount","componentDidUnMount","removeAllListeners","id","alpha","split","length","i","Math","floor","random","splice","newStack","slice","show","setState","top","item","forceUpdate","setTimeout","reduce","array","value","index","render","map","child","result","classes"],"sources":["/Users/hyunjoo/cording/typescript/react-rest-manager/front/src/dialog/DialogManager.js"],"sourcesContent":["import React from 'react';\nimport classNames from \"classnames\";\nimport { createEventBusHelper } from \"../utils/EventBusHelper\";\nimport EventTypes from \"../consts/EventTypes\";\n\n// EventBusHelper라는 새로운 인스턴스를 생성한다.\nconst EventBusHelper = createEventBusHelper();\n\nexport default class DialogManager extends React.Component {\n  static push(dialog) {\n    EventBusHelper.publish(EventTypes.Dialog.Push, dialog);\n  }\n\n  static pushAsync(dialog) {\n    return new Promise((resolve, reject) => {\n      EventBusHelper.publish(EventTypes.Dialog.Push, React.cloneElement(dialog, {onClose: resolve}));\n    });\n  }\n\n  static pop() {\n    EventBusHelper.publish(EventTypes.Dialog.Pop);\n  }\n\n  _isMounted = false;\n\n  state = {\n    stack: []\n  };\n\n  constructor(props, context) {\n    super(props, context);\n\n    // this.push에는 this가 this로 고정된 this.push이 할당\n    this.push = this.push.bind(this);\n    this.pop = this.pop.bind(this);\n\n    EventBusHelper.addListener(EventTypes.Dialog.Push, this.push);\n    EventBusHelper.addListener(EventTypes.Dialog.Pop, this.pop);\n  }\n\n  componentDidMount() {\n    this._isMounted = true;\n  }\n\n  componentDidUnMount() {\n    this._isMounted = false;\n    EventBusHelper.removeAllListeners();\n  }\n\n  id() {\n    const alpha = 'qwertyuiopasdfghjklzxcvbnm'.split('');\n    let id = '';\n    while (alpha.length) {\n      const i = Math.floor(Math.random() * alpha.length);\n      id += alpha[i];\n      alpha.splice(i, 1);\n    }\n    return id;\n  }\n\n  push(dialog) {\n    if (!this._isMounted) {\n      return;\n    }\n    const newStack = this.state.stack.slice();\n    newStack.push({id: this.id(), show: true, dialog});\n    this.setState(() => ({stack: newStack}));\n  }\n\n  pop() {\n    if (!this._isMounted) {\n      return;\n    }\n\n    let {stack} = this.state;\n    let top = null;\n    for (let i = stack.length - 1; 0 <= i; i--) {\n      const item = stack[i];\n      if (item.show === true) {\n        top = item;\n        break;\n      }\n    }\n    if (!top) {\n      return;\n    }\n\n    top.show = false;\n    this.forceUpdate();\n\n    setTimeout(() => {\n      const newStack = stack.reduce((array, value, index) => {\n        if (top.id !== value.id) {\n          array.push(value);\n        }\n        return array;\n      }, []);\n      this.setState({stack: newStack});\n    }, 300);\n  }\n\n  render() {\n    return (\n      <>\n        {this.state.stack.map((value, index) => {\n          const {id, show, dialog} = value;\n          const child = React.cloneElement(dialog, {\n            show,\n            onClose: (result) => {\n              this.pop();\n              if (dialog.props.onClose) {\n                setTimeout(() => {\n                  dialog.props.onClose(result);\n                }, 300);\n              }\n            }\n          });\n          const classes = classNames(\n            'c-default-layout', 'c-legacy-theme',\n            `dialog-${index}`,\n          );\n          return <div className={classes} key={id}>{child}</div>;\n        })}\n      </>\n    );\n  }\n}\n"],"mappings":";AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,OAAOC,UAAU,MAAM,YAAY;AACnC,SAASC,oBAAoB,QAAQ,yBAAyB;AAC9D,OAAOC,UAAU,MAAM,sBAAsB;;AAE7C;AAAA;AAAA;AACA,MAAMC,cAAc,GAAGF,oBAAoB,EAAE;AAE7C,eAAe,MAAMG,aAAa,SAASL,KAAK,CAACM,SAAS,CAAC;EACzD,OAAOC,IAAI,CAACC,MAAM,EAAE;IAClBJ,cAAc,CAACK,OAAO,CAACN,UAAU,CAACO,MAAM,CAACC,IAAI,EAAEH,MAAM,CAAC;EACxD;EAEA,OAAOI,SAAS,CAACJ,MAAM,EAAE;IACvB,OAAO,IAAIK,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;MACtCX,cAAc,CAACK,OAAO,CAACN,UAAU,CAACO,MAAM,CAACC,IAAI,eAAEX,KAAK,CAACgB,YAAY,CAACR,MAAM,EAAE;QAACS,OAAO,EAAEH;MAAO,CAAC,CAAC,CAAC;IAChG,CAAC,CAAC;EACJ;EAEA,OAAOI,GAAG,GAAG;IACXd,cAAc,CAACK,OAAO,CAACN,UAAU,CAACO,MAAM,CAACS,GAAG,CAAC;EAC/C;EAQAC,WAAW,CAACC,KAAK,EAAEC,OAAO,EAAE;IAC1B,KAAK,CAACD,KAAK,EAAEC,OAAO,CAAC;;IAErB;IAAA,KATFC,UAAU,GAAG,KAAK;IAAA,KAElBC,KAAK,GAAG;MACNC,KAAK,EAAE;IACT,CAAC;IAMC,IAAI,CAAClB,IAAI,GAAG,IAAI,CAACA,IAAI,CAACmB,IAAI,CAAC,IAAI,CAAC;IAChC,IAAI,CAACR,GAAG,GAAG,IAAI,CAACA,GAAG,CAACQ,IAAI,CAAC,IAAI,CAAC;IAE9BtB,cAAc,CAACuB,WAAW,CAACxB,UAAU,CAACO,MAAM,CAACC,IAAI,EAAE,IAAI,CAACJ,IAAI,CAAC;IAC7DH,cAAc,CAACuB,WAAW,CAACxB,UAAU,CAACO,MAAM,CAACS,GAAG,EAAE,IAAI,CAACD,GAAG,CAAC;EAC7D;EAEAU,iBAAiB,GAAG;IAClB,IAAI,CAACL,UAAU,GAAG,IAAI;EACxB;EAEAM,mBAAmB,GAAG;IACpB,IAAI,CAACN,UAAU,GAAG,KAAK;IACvBnB,cAAc,CAAC0B,kBAAkB,EAAE;EACrC;EAEAC,EAAE,GAAG;IACH,MAAMC,KAAK,GAAG,4BAA4B,CAACC,KAAK,CAAC,EAAE,CAAC;IACpD,IAAIF,EAAE,GAAG,EAAE;IACX,OAAOC,KAAK,CAACE,MAAM,EAAE;MACnB,MAAMC,CAAC,GAAGC,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,MAAM,EAAE,GAAGN,KAAK,CAACE,MAAM,CAAC;MAClDH,EAAE,IAAIC,KAAK,CAACG,CAAC,CAAC;MACdH,KAAK,CAACO,MAAM,CAACJ,CAAC,EAAE,CAAC,CAAC;IACpB;IACA,OAAOJ,EAAE;EACX;EAEAxB,IAAI,CAACC,MAAM,EAAE;IACX,IAAI,CAAC,IAAI,CAACe,UAAU,EAAE;MACpB;IACF;IACA,MAAMiB,QAAQ,GAAG,IAAI,CAAChB,KAAK,CAACC,KAAK,CAACgB,KAAK,EAAE;IACzCD,QAAQ,CAACjC,IAAI,CAAC;MAACwB,EAAE,EAAE,IAAI,CAACA,EAAE,EAAE;MAAEW,IAAI,EAAE,IAAI;MAAElC;IAAM,CAAC,CAAC;IAClD,IAAI,CAACmC,QAAQ,CAAC,OAAO;MAAClB,KAAK,EAAEe;IAAQ,CAAC,CAAC,CAAC;EAC1C;EAEAtB,GAAG,GAAG;IACJ,IAAI,CAAC,IAAI,CAACK,UAAU,EAAE;MACpB;IACF;IAEA,IAAI;MAACE;IAAK,CAAC,GAAG,IAAI,CAACD,KAAK;IACxB,IAAIoB,GAAG,GAAG,IAAI;IACd,KAAK,IAAIT,CAAC,GAAGV,KAAK,CAACS,MAAM,GAAG,CAAC,EAAE,CAAC,IAAIC,CAAC,EAAEA,CAAC,EAAE,EAAE;MAC1C,MAAMU,IAAI,GAAGpB,KAAK,CAACU,CAAC,CAAC;MACrB,IAAIU,IAAI,CAACH,IAAI,KAAK,IAAI,EAAE;QACtBE,GAAG,GAAGC,IAAI;QACV;MACF;IACF;IACA,IAAI,CAACD,GAAG,EAAE;MACR;IACF;IAEAA,GAAG,CAACF,IAAI,GAAG,KAAK;IAChB,IAAI,CAACI,WAAW,EAAE;IAElBC,UAAU,CAAC,MAAM;MACf,MAAMP,QAAQ,GAAGf,KAAK,CAACuB,MAAM,CAAC,CAACC,KAAK,EAAEC,KAAK,EAAEC,KAAK,KAAK;QACrD,IAAIP,GAAG,CAACb,EAAE,KAAKmB,KAAK,CAACnB,EAAE,EAAE;UACvBkB,KAAK,CAAC1C,IAAI,CAAC2C,KAAK,CAAC;QACnB;QACA,OAAOD,KAAK;MACd,CAAC,EAAE,EAAE,CAAC;MACN,IAAI,CAACN,QAAQ,CAAC;QAAClB,KAAK,EAAEe;MAAQ,CAAC,CAAC;IAClC,CAAC,EAAE,GAAG,CAAC;EACT;EAEAY,MAAM,GAAG;IACP,oBACE;MAAA,UACG,IAAI,CAAC5B,KAAK,CAACC,KAAK,CAAC4B,GAAG,CAAC,CAACH,KAAK,EAAEC,KAAK,KAAK;QACtC,MAAM;UAACpB,EAAE;UAAEW,IAAI;UAAElC;QAAM,CAAC,GAAG0C,KAAK;QAChC,MAAMI,KAAK,gBAAGtD,KAAK,CAACgB,YAAY,CAACR,MAAM,EAAE;UACvCkC,IAAI;UACJzB,OAAO,EAAGsC,MAAM,IAAK;YACnB,IAAI,CAACrC,GAAG,EAAE;YACV,IAAIV,MAAM,CAACa,KAAK,CAACJ,OAAO,EAAE;cACxB8B,UAAU,CAAC,MAAM;gBACfvC,MAAM,CAACa,KAAK,CAACJ,OAAO,CAACsC,MAAM,CAAC;cAC9B,CAAC,EAAE,GAAG,CAAC;YACT;UACF;QACF,CAAC,CAAC;QACF,MAAMC,OAAO,GAAGvD,UAAU,CACxB,kBAAkB,EAAE,gBAAgB,EACnC,UAASkD,KAAM,EAAC,CAClB;QACD,oBAAO;UAAK,SAAS,EAAEK,OAAQ;UAAA,UAAWF;QAAK,GAAVvB,EAAE;UAAA;UAAA;UAAA;QAAA,QAAe;MACxD,CAAC;IAAC,iBACD;EAEP;AACF"},"metadata":{},"sourceType":"module","externalDependencies":[]}